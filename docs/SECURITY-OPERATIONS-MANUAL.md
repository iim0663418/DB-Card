# å®‰å…¨æ“ä½œæ‰‹å†Š

## æ¦‚è¿°
æœ¬æ‰‹å†Šæä¾› NFC æ•¸ä½åç‰‡ç³»çµ±çš„å®Œæ•´å®‰å…¨æ“ä½œæŒ‡å¼•ï¼Œæ¶µè“‹æ—¥å¸¸ç¶­è­·ã€äº‹ä»¶å›æ‡‰ã€ç›£æ§å‘Šè­¦ç­‰é—œéµå®‰å…¨æ“ä½œç¨‹åºã€‚

## ğŸ”’ å®‰å…¨æ¶æ§‹æ¦‚è¦½

### ä¸‰å±¤å®‰å…¨é˜²è­·
- **è¼¸å…¥å±¤**: SecurityInputHandler - è¼¸å…¥é©—è­‰èˆ‡æ¸…ç†
- **èªè­‰å±¤**: SecurityAuthHandler - æˆæ¬Šæª¢æŸ¥èˆ‡æœƒè©±ç®¡ç†
- **è³‡æ–™å±¤**: SecurityDataHandler - XSSé˜²è­·èˆ‡å®‰å…¨å„²å­˜

### PWA åŒ¯å…¥/åŒ¯å‡ºåŠŸèƒ½å®‰å…¨ç‹€æ…‹ (å·²ä¿®å¾©å®Œæˆ)
- âœ… **SEC-PWA-001**: æª”æ¡ˆä¸Šå‚³æ”»æ“Š (CWE-434) - å·²å®Œæˆä¿®å¾©ä¸¦é€šéæ¸¬è©¦
- âœ… **SEC-PWA-002**: JSON.parse Prototype Pollution (CWE-1321) - å·²å®Œæˆä¿®å¾©ä¸¦é€šéæ¸¬è©¦
- âœ… **SEC-PWA-003**: æˆæ¬Šæª¢æŸ¥ç¼ºå¤± (CWE-862) - å·²å®Œæˆä¿®å¾©ä¸¦é€šéæ¸¬è©¦
- âœ… **SEC-PWA-004**: PII è³‡æ–™æ´©éœ² (CWE-359) - å·²å®Œæˆä¿®å¾©ä¸¦é€šéæ¸¬è©¦
- âœ… **SEC-PWA-005**: ä¸å®‰å…¨çš„æª”æ¡ˆè™•ç† (CWE-73) - å·²å®Œæˆä¿®å¾©ä¸¦é€šéæ¸¬è©¦
- âœ… **SEC-PWA-006**: è³‡æ–™æ³¨å…¥æ”»æ“Š (CWE-74) - å·²å®Œæˆä¿®å¾©ä¸¦é€šéæ¸¬è©¦
- âœ… **SEC-PWA-007**: ä¸å®‰å…¨çš„ååºåˆ—åŒ– (CWE-502) - å·²å®Œæˆä¿®å¾©ä¸¦é€šéæ¸¬è©¦
- âœ… **SEC-PWA-008**: éŒ¯èª¤è™•ç†è³‡è¨Šæ´©éœ² (CWE-209) - å·²å®Œæˆä¿®å¾©ä¸¦é€šéæ¸¬è©¦
- âœ… **EXP-SECURITY**: åŒ¯å‡ºåŠŸèƒ½å®‰å…¨å¼·åŒ– - æª”æ¡ˆå¤§å°é©—è­‰ã€æª”åæ¸…ç†ã€è¨˜æ†¶é«”ç®¡ç†å®Œæˆ

### å·²ä¿®å¾©çš„å®‰å…¨æ¼æ´
- âœ… SEC-001: ç”Ÿç”¢ç’°å¢ƒ prompt() ä½¿ç”¨ (Critical)
- âœ… SEC-002: ä¸å®‰å…¨å¯†ç¢¼è¼¸å…¥ (Critical)
- âœ… SEC-003: confirm() å°è©±æ¡†æ¿«ç”¨ (Critical)
- âœ… SEC-004: æ—¥èªŒæ³¨å…¥æ¼æ´ CWE-117 (High)
- âœ… SEC-005: XSSæ¼æ´ CWE-79 (High)
- âœ… SEC-006: æˆæ¬Šæª¢æŸ¥ç¼ºå¤± CWE-862 (High)

## ğŸ“‹ æ—¥å¸¸å®‰å…¨æ“ä½œ

### 1. å®‰å…¨ç‹€æ…‹æª¢æŸ¥
```javascript
// åŸ·è¡Œå®Œæ•´å®‰å…¨æ¸¬è©¦
const results = await SecurityTestSuite.runAllTests();
console.log(`å®‰å…¨æ¸¬è©¦çµæœ: ${results.passed} é€šé, ${results.failed} å¤±æ•—`);

// åŸ·è¡Œæ»²é€æ¸¬è©¦
const penTest = await SecurityTestSuite.runPenetrationTests();
console.log(`æ»²é€æ¸¬è©¦: ${penTest.blocked}/${penTest.total} æ”»æ“Šè¢«é˜»æ“‹`);
```

### 2. æœƒè©±ç®¡ç†ç›£æ§
```javascript
// æª¢æŸ¥æ´»èºæœƒè©±
const activeSessions = SecurityAuthHandler.getActiveSessions();
console.log(`ç›®å‰æ´»èºæœƒè©±æ•¸: ${activeSessions.length}`);

// æ¸…ç†éæœŸæœƒè©±
SecurityAuthHandler.cleanupExpiredSessions();
```

### 3. æ—¥èªŒå®‰å…¨æª¢æŸ¥
```javascript
// æª¢æŸ¥æ—¥èªŒå®Œæ•´æ€§
const logIntegrity = await SecurityDataHandler.validateLogIntegrity();
if (!logIntegrity.valid) {
    console.warn('æ—¥èªŒå®Œæ•´æ€§æª¢æŸ¥å¤±æ•—');
}
```

## ğŸš¨ å®‰å…¨äº‹ä»¶å›æ‡‰

### PWA åŒ¯å…¥/åŒ¯å‡ºåŠŸèƒ½ Critical ç´šåˆ¥äº‹ä»¶å›æ‡‰
**ç·Šæ€¥è¡Œå‹•è¨ˆç•« (< 15 åˆ†é˜)**
1. **ç«‹å³åœç”¨ PWA åŒ¯å…¥/åŒ¯å‡ºåŠŸèƒ½**
   ```javascript
   // ç·Šæ€¥åœç”¨åŒ¯å…¥åŠŸèƒ½
   window.EMERGENCY_DISABLE_IMPORT = true;
   
   // ç·Šæ€¥åœç”¨åŒ¯å‡ºåŠŸèƒ½ (å¦‚éœ€è¦)
   window.EMERGENCY_DISABLE_EXPORT = true;
   ```
2. **éš”é›¢å—å½±éŸ¿æª”æ¡ˆ**
   - `pwa-card-storage/src/features/transfer-manager.js`
   - `pwa-card-storage/src/features/card-manager.js`
3. **å•Ÿå‹•ç·Šæ€¥ä¿®å¾©å°çµ„**
4. **é€šçŸ¥æ‰€æœ‰ç”¨æˆ¶åœæ­¢ä½¿ç”¨åŒ¯å…¥/åŒ¯å‡ºåŠŸèƒ½**

### Critical ç´šåˆ¥äº‹ä»¶
**ç«‹å³è¡Œå‹• (< 15 åˆ†é˜)**
1. éš”é›¢å—å½±éŸ¿ç³»çµ±
2. å•Ÿå‹•äº‹ä»¶å›æ‡‰å°çµ„
3. æ”¶é›†åˆæ­¥è­‰æ“š
4. é€šçŸ¥ç›¸é—œåˆ©å®³é—œä¿‚äºº

### High ç´šåˆ¥äº‹ä»¶
**å¿«é€Ÿå›æ‡‰ (< 1 å°æ™‚)**
1. è©•ä¼°å½±éŸ¿ç¯„åœ
2. å¯¦æ–½è‡¨æ™‚ç·©è§£æªæ–½
3. é–‹å§‹è©³ç´°èª¿æŸ¥
4. æº–å‚™ä¿®å¾©è¨ˆç•«

### äº‹ä»¶åˆ†é¡æ¨™æº–
- **Critical**: ç³»çµ±å®Œå…¨å¦¥å”ã€è³‡æ–™å¤–æ´©
- **High**: éƒ¨åˆ†åŠŸèƒ½å—å½±éŸ¿ã€æ½›åœ¨å®‰å…¨é¢¨éšª
- **Medium**: è¼•å¾®å®‰å…¨å•é¡Œã€æ•ˆèƒ½å½±éŸ¿
- **Low**: ä¸€èˆ¬æ€§å•é¡Œã€å»ºè­°æ”¹å–„

## ğŸ“Š å®‰å…¨ç›£æ§èˆ‡å‘Šè­¦

### 1. è‡ªå‹•ç›£æ§æŒ‡æ¨™
```javascript
// ç›£æ§é…ç½®
const securityMetrics = {
    failedAuthAttempts: { threshold: 5, window: '5m' },
    suspiciousInputs: { threshold: 10, window: '1h' },
    sessionAnomalies: { threshold: 3, window: '10m' },
    logInjectionAttempts: { threshold: 1, window: '1m' }
};
```

### 2. å‘Šè­¦è§¸ç™¼æ¢ä»¶
- é€£çºŒ 5 æ¬¡æˆæ¬Šå¤±æ•—
- æª¢æ¸¬åˆ° XSS æ”»æ“Šå˜—è©¦
- ç•°å¸¸çš„æœƒè©±è¡Œç‚º
- æ—¥èªŒæ³¨å…¥æ”»æ“Šå˜—è©¦
- ç³»çµ±è³‡æºç•°å¸¸ä½¿ç”¨

### 3. ç›£æ§å„€è¡¨æ¿æŒ‡æ¨™
- å®‰å…¨äº‹ä»¶æ•¸é‡è¶¨å‹¢
- æ”»æ“Šé¡å‹åˆ†å¸ƒ
- ç³»çµ±å¥åº·ç‹€æ…‹
- æœƒè©±æ´»å‹•çµ±è¨ˆ

## ğŸ§ª å®‰å…¨æ¸¬è©¦å¥—ä»¶åŸ·è¡ŒæŒ‡å—

### Jest æ¸¬è©¦æ¡†æ¶åŸ·è¡Œ (å»ºè­°)

#### å¿«é€Ÿå®‰å…¨é©—è­‰
```bash
# é€²å…¥æ¸¬è©¦ç›®éŒ„
cd tests/

# å®‰è£æ¸¬è©¦ä¾è³´ (é¦–æ¬¡åŸ·è¡Œ)
npm install

# åŸ·è¡Œå®‰å…¨æ¸¬è©¦å¥—ä»¶ (45å€‹æ¸¬è©¦æ¡ˆä¾‹)
npm run test:security

# æª¢æŸ¥çµæœ
# âœ… æ‰€æœ‰æ¸¬è©¦é€šé = ç³»çµ±å®‰å…¨
# âŒ æœ‰æ¸¬è©¦å¤±æ•— = éœ€è¦ç«‹å³èª¿æŸ¥
```

#### å®Œæ•´æ¸¬è©¦åŸ·è¡Œ
```bash
# åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦ä¸¦ç”Ÿæˆè¦†è“‹ç‡å ±å‘Š
npm run test:all

# æŒçºŒç›£æ§æ¨¡å¼ (é–‹ç™¼æ™‚ä½¿ç”¨)
npm run test:security:watch

# CI/CD ç’°å¢ƒåŸ·è¡Œ
npm run test:ci
```

### è¦–è¦ºåŒ–æ¸¬è©¦åŸ·è¡Œå™¨ä½¿ç”¨

#### åŸºæœ¬æ“ä½œ
1. é–‹å•Ÿ `tests/security/security-test-runner.html`
2. é»æ“Šã€ŒåŸ·è¡Œå®Œæ•´å®‰å…¨æ¸¬è©¦ã€
3. ç›£æ§ 45 å€‹æ¸¬è©¦æ¡ˆä¾‹çš„å³æ™‚åŸ·è¡Œé€²åº¦
4. æª¢æŸ¥å®‰å…¨ç‹€æ…‹é¡¯ç¤ºï¼š
   - ğŸŸ¢ å®‰å…¨ï¼šæ‰€æœ‰æ¸¬è©¦é€šé
   - ğŸ”´ å±éšªï¼šæœ‰æ¸¬è©¦å¤±æ•—
   - âš ï¸ æœªçŸ¥ï¼šå°šæœªåŸ·è¡Œæ¸¬è©¦

#### ç·Šæ€¥åŠŸèƒ½æ¸¬è©¦
```javascript
// æ¸¬è©¦ç·Šæ€¥åœç”¨åŠŸèƒ½
1. é»æ“Šã€Œç·Šæ€¥åœç”¨åŒ¯å…¥åŠŸèƒ½ã€
2. åŸ·è¡Œå¿«é€Ÿé©—è­‰æ¸¬è©¦
3. ç¢ºèªæ‰€æœ‰åŒ¯å…¥æ“ä½œè¢«æ‹’çµ•
4. é»æ“Šã€Œæ¢å¾©åŒ¯å…¥åŠŸèƒ½ã€
5. é‡æ–°æ¸¬è©¦æ­£å¸¸åŠŸèƒ½
```

#### æª”æ¡ˆå®‰å…¨æ¸¬è©¦
- æ‹–æ‹½æ¸¬è©¦æª”æ¡ˆåˆ°ä¸Šå‚³å€åŸŸ
- ç³»çµ±è‡ªå‹•åŸ·è¡Œï¼š
  - æª”æ¡ˆé¡å‹æª¢æŸ¥
  - æª”æ¡ˆå¤§å°æª¢æŸ¥  
  - æª”æ¡ˆåç¨±å®‰å…¨æª¢æŸ¥
- æŸ¥çœ‹å³æ™‚æ¸¬è©¦çµæœ

### æ¸¬è©¦çµæœè§£è®€

#### æ¸¬è©¦æˆåŠŸæŒ‡æ¨™
- **ç¸½æ¸¬è©¦æ•¸**: 45 å€‹
- **é€šéç‡**: 100%
- **Critical å®‰å…¨æ¸¬è©¦**: 32/32 é€šé
- **ç·Šæ€¥æ©Ÿåˆ¶æ¸¬è©¦**: 2/2 é€šé
- **åŠŸèƒ½é©—è­‰æ¸¬è©¦**: 8/8 é€šé  
- **åˆè¦æ€§æ¸¬è©¦**: 4/4 é€šé

#### å¤±æ•—æ’é™¤æ­¥é©Ÿ
1. **æª¢æŸ¥æ¸¬è©¦æ—¥èªŒ**: æŸ¥çœ‹å…·é«”å¤±æ•—åŸå› 
2. **é‡ç½®æ¸¬è©¦ç’°å¢ƒ**: é»æ“Šã€Œé‡ç½®æ¸¬è©¦ç’°å¢ƒã€
3. **å–®ç¨æ¸¬è©¦**: åŸ·è¡Œå¿«é€Ÿé©—è­‰æ¸¬è©¦
4. **æª¢æŸ¥ä»£ç¢¼è®Šæ›´**: ç¢ºèªæœ€è¿‘æ˜¯å¦æœ‰ä¿®æ”¹æ ¸å¿ƒæª”æ¡ˆ
5. **è¯çµ¡å®‰å…¨åœ˜éšŠ**: å¦‚å•é¡ŒæŒçºŒå­˜åœ¨

### æŒçºŒç›£æ§å»ºè­°

#### è‡ªå‹•åŒ–åŸ·è¡Œ
```bash
# è¨­å®š cron job æ¯æ—¥åŸ·è¡Œ
0 9 * * * cd /path/to/tests && npm run test:security

# è¨­å®š CI/CD è§¸ç™¼æ¢ä»¶
- æ¯æ¬¡ç¨‹å¼ç¢¼æäº¤å¾Œè‡ªå‹•åŸ·è¡Œ
- éƒ¨ç½²å‰å¼·åˆ¶åŸ·è¡Œå®‰å…¨æ¸¬è©¦
- é€±æœŸæ€§å®Œæ•´æ¸¬è©¦åŸ·è¡Œ
```

#### ç›£æ§å‘Šè­¦
- æ¸¬è©¦å¤±æ•—ç«‹å³ç™¼é€å‘Šè­¦
- åŸ·è¡Œæ™‚é–“ç•°å¸¸å‘Šè­¦  
- è¦†è“‹ç‡ä¸‹é™å‘Šè­¦
- æ–°å¢æ¸¬è©¦æ¡ˆä¾‹æé†’

## ğŸ”§ å®‰å…¨é…ç½®ç®¡ç†

### 1. å®‰å…¨åƒæ•¸é…ç½®
```javascript
const SecurityConfig = {
    // æœƒè©±ç®¡ç†
    session: {
        timeout: 30 * 60 * 1000,    // 30åˆ†é˜
        maxSessions: 10,             // æœ€å¤§ä¸¦ç™¼æœƒè©±
        renewThreshold: 5 * 60 * 1000 // 5åˆ†é˜çºŒæœŸé–¾å€¼
    },
    
    // è¼¸å…¥é©—è­‰
    input: {
        maxLength: 1000,
        sanitizeLevel: 'strict',
        allowedTags: []
    },
    
    // æ—¥èªŒè¨­å®š
    logging: {
        level: 'info',
        retention: 30,               // ä¿ç•™30å¤©
        maxSize: 10 * 1024 * 1024   // 10MB
    }
};
```

### 2. æ¬Šé™çŸ©é™£
| è³‡æº | è®€å– | å¯«å…¥ | åˆªé™¤ | ç®¡ç† |
|------|------|------|------|------|
| card-data | âœ… | âœ… | âœ… | âŒ |
| storage | âœ… | âœ… | âŒ | âŒ |
| export | âœ… | âŒ | âŒ | âŒ |
| import | âŒ | âœ… | âŒ | âŒ |
| admin | âŒ | âŒ | âŒ | âœ… |

### 3. åŒ¯å‡ºåŠŸèƒ½å®‰å…¨æ“ä½œæŒ‡å—

#### 3.1 æ—¥å¸¸åŒ¯å‡ºæ“ä½œå®‰å…¨æª¢æŸ¥
```javascript
// åŸ·è¡ŒåŒ¯å‡ºå‰å®‰å…¨æª¢æŸ¥
const securityCheck = await cardManager.performExportSecurityCheck();
if (!securityCheck.safe) {
    console.warn('åŒ¯å‡ºå®‰å…¨æª¢æŸ¥å¤±æ•—:', securityCheck.issues);
    return;
}

// ç›£æ§æª”æ¡ˆå¤§å°è­¦å‘Š
const result = await cardManager.exportCards({ exportAll: true });
if (result.files) {
    result.files.forEach(file => {
        const warning = cardManager.checkFileSizeWarning(file.size);
        if (warning.level !== 'ok') {
            console.warn(`æª”æ¡ˆå¤§å°è­¦å‘Š: ${warning.message}`);
        }
    });
}
```

#### 3.2 åŒ¯å‡ºå®‰å…¨æœ€ä½³å¯¦è¸
1. **æª”æ¡ˆå¤§å°ç›£æ§**
   - å°æ–¼ 5MB: æ­£å¸¸è™•ç†
   - 5-10MB: é¡¯ç¤ºè³‡è¨Šè­¦å‘Š
   - 10-50MB: é¡¯ç¤ºå¤§å°è­¦å‘Š
   - è¶…é 50MB: æ‹’çµ•åŒ¯å‡ºä¸¦é¡¯ç¤ºéŒ¯èª¤

2. **æª”åå®‰å…¨é©—è­‰**
   - ç§»é™¤è·¯å¾‘éæ­·å­—ç¬¦ (`../`, `./`)
   - æ¸…ç†ç‰¹æ®Šå­—ç¬¦å’Œç©ºæ ¼
   - ç¢ºä¿æª”åé•·åº¦åˆç† (< 255 å­—ç¬¦)

3. **è¨˜æ†¶é«”å®‰å…¨ç®¡ç†**
   - è‡ªå‹•æ¸…ç† Blob URLs
   - ç›£æ§å¤§é‡åŒ¯å‡ºçš„è¨˜æ†¶é«”ä½¿ç”¨
   - å¯¦æ–½åŒ¯å‡ºæ•¸é‡é™åˆ¶ (< 1000 å¼µåç‰‡)

4. **è³‡æ–™æ¸…ç†æª¢æŸ¥**
   - ç¢ºä¿æ‰€æœ‰åŒ¯å‡ºè³‡æ–™ç¶“éæ¸…ç†
   - é©—è­‰é›™èªåˆ†é›¢é‚è¼¯æ­£ç¢ºæ€§
   - æª¢æŸ¥æ•æ„Ÿè³‡æ–™é®ç½©

## ğŸ› ï¸ ç¶­è­·ç¨‹åº

### æ¯æ—¥æª¢æŸ¥æ¸…å–®
- [ ] åŸ·è¡Œå®‰å…¨æ¸¬è©¦å¥—ä»¶ (45å€‹åŒ¯å…¥å®‰å…¨æ¸¬è©¦æ¡ˆä¾‹)
- [ ] åŸ·è¡ŒåŒ¯å‡ºåŠŸèƒ½æ¸¬è©¦ (38å€‹åŒ¯å‡ºåŠŸèƒ½æ¸¬è©¦æ¡ˆä¾‹)
- [ ] **PWA åŒ¯å…¥/åŒ¯å‡ºåŠŸèƒ½å®‰å…¨ç‹€æ…‹æª¢æŸ¥** (å·²ä¿®å¾©ï¼ŒæŒçºŒç›£æ§)
- [ ] åŸ·è¡Œ Jest å®‰å…¨æ¸¬è©¦: `npm run test:security`
- [ ] åŸ·è¡ŒåŒ¯å‡ºé©—è­‰æ¸¬è©¦: `npm run test tests/smoke/export-validation.test.js`
- [ ] æª¢æŸ¥è¦–è¦ºåŒ–æ¸¬è©¦å™¨ç‹€æ…‹: `security-test-runner.html`
- [ ] ç›£æ§åŒ¯å‡ºæª”æ¡ˆå¤§å°ç•°å¸¸ (> 50MB è­¦å‘Š)
- [ ] æª¢æŸ¥ç³»çµ±æ—¥èªŒç•°å¸¸
- [ ] ç›£æ§æª”æ¡ˆä¸Šå‚³æ”»æ“Šå˜—è©¦
- [ ] é©—è­‰å‚™ä»½å®Œæ•´æ€§
- [ ] ç›£æ§è³‡æºä½¿ç”¨ç‹€æ³
- [ ] æª¢æŸ¥æœƒè©±æ´»å‹•

### æ¯é€±æª¢æŸ¥æ¸…å–®
- [ ] åŸ·è¡Œå®Œæ•´æ»²é€æ¸¬è©¦
- [ ] æ›´æ–°å®‰å…¨è¦å‰‡
- [ ] æª¢æŸ¥ä¾è³´å¥—ä»¶å®‰å…¨æ€§
- [ ] å¯©æŸ¥å­˜å–æ—¥èªŒ
- [ ] æ¸¬è©¦ç½é›£æ¢å¾©ç¨‹åº

### æ¯æœˆæª¢æŸ¥æ¸…å–®
- [ ] å…¨é¢å®‰å…¨è©•ä¼°
- [ ] æ›´æ–°å¨è„…æ¨¡å‹
- [ ] æª¢æŸ¥åˆè¦æ€§ç‹€æ…‹
- [ ] å®‰å…¨åŸ¹è¨“æ›´æ–°
- [ ] äº‹ä»¶å›æ‡‰æ¼”ç·´

## ğŸ” æ•…éšœæ’é™¤æŒ‡å—

### PWA åŒ¯å…¥/åŒ¯å‡ºåŠŸèƒ½ç·Šæ€¥å•é¡Œ

#### 1. æª”æ¡ˆä¸Šå‚³æ”»æ“Šæª¢æ¸¬
**ç—‡ç‹€**: ä¸æ˜æª”æ¡ˆè¢«ä¸Šå‚³æˆ–ç•°å¸¸æª”æ¡ˆé¡å‹
**ç·Šæ€¥è™•ç†**:
```javascript
// ç«‹å³åœç”¨åŒ¯å…¥åŠŸèƒ½
window.EMERGENCY_DISABLE_IMPORT = true;

// æª¢æŸ¥ä¸Šå‚³æª”æ¡ˆè¨˜éŒ„
const uploadLogs = SecurityMonitor.getSecurityEvents('file_upload');
console.log('æª”æ¡ˆä¸Šå‚³è¨˜éŒ„:', uploadLogs);

// æ¸…ç†å¯ç–‘æª”æ¡ˆ
SecurityDataHandler.quarantineSuspiciousFiles();
```

#### 2. JSON Prototype Pollution æ”»æ“Š
**ç—‡ç‹€**: ç‰©ä»¶åŸå‹è¢«æ±¡æŸ“ï¼Œç³»çµ±è¡Œç‚ºç•°å¸¸
**ç·Šæ€¥è™•ç†**:
```javascript
// æª¢æŸ¥åŸå‹æ±¡æŸ“
if (Object.prototype.hasOwnProperty('__proto__')) {
  console.error('Prototype pollution detected!');
  // é‡æ–°è¼‰å…¥é é¢
  window.location.reload();
}

// æ¸…ç†å¯ç–‘è³‡æ–™
SecurityDataHandler.sanitizeStoredData();
```

#### 3. PII è³‡æ–™æ´©éœ²
**ç—‡ç‹€**: å€‹äººè³‡æ–™å‡ºç¾åœ¨æ—¥èªŒæˆ–éŒ¯èª¤è¨Šæ¯ä¸­
**ç·Šæ€¥è™•ç†**:
```javascript
// ç«‹å³æ¸…ç†æ—¥èªŒ
SecurityDataHandler.clearSensitiveLogs();

// åœç”¨è©³ç´°éŒ¯èª¤è¨Šæ¯
window.DISABLE_DETAILED_ERRORS = true;

// é€šçŸ¥ç”¨æˆ¶æ›´æ–°å¯†ç¢¼
SecurityAuthHandler.forcePasswordReset();
```

#### 4. åŒ¯å‡ºåŠŸèƒ½ç•°å¸¸æª”æ¡ˆå¤§å°
**ç—‡ç‹€**: åŒ¯å‡ºæª”æ¡ˆè¶…éæ­£å¸¸å¤§å°é™åˆ¶ (> 50MB)
**ç·Šæ€¥è™•ç†**:
```javascript
// æª¢æŸ¥åŒ¯å‡ºæª”æ¡ˆå¤§å°
const exportSize = await cardManager.getExportPreview(null, 'json');
if (exportSize.preview.estimatedSizes.json > 50 * 1024 * 1024) {
    console.error('åŒ¯å‡ºæª”æ¡ˆéå¤§ï¼Œå¯èƒ½çš„åŸå› :');
    console.log('- åç‰‡æ•¸é‡ç•°å¸¸:', exportSize.preview.totalCards);
    console.log('- è³‡æ–™è†¨è„¹æ”»æ“Š');
    
    // ç·Šæ€¥åœç”¨åŒ¯å‡ºåŠŸèƒ½
    window.EMERGENCY_DISABLE_EXPORT = true;
    
    // é™åˆ¶åŒ¯å‡ºæ•¸é‡
    cardManager.MAX_EXPORT_CARDS = 100;
}
```

#### 5. åŒ¯å‡ºè¨˜æ†¶é«”æ´©æ¼
**ç—‡ç‹€**: å¤šæ¬¡åŒ¯å‡ºå¾Œç€è¦½å™¨è¨˜æ†¶é«”ä½¿ç”¨ç•°å¸¸å¢åŠ 
**ç·Šæ€¥è™•ç†**:
```javascript
// å¼·åˆ¶æ¸…ç†æ‰€æœ‰ Blob URLs
if (window.activeExportUrls) {
    window.activeExportUrls.forEach(url => URL.revokeObjectURL(url));
    window.activeExportUrls = [];
}

// è§¸ç™¼åƒåœ¾å›æ”¶ (å¦‚æœæ”¯æ´)
if (window.gc) {
    window.gc();
}

// é‡æ–°è¼‰å…¥é é¢ä»¥æ¸…ç†è¨˜æ†¶é«”
setTimeout(() => window.location.reload(), 5000);
```

### å¸¸è¦‹å®‰å…¨å•é¡Œ

#### 1. æˆæ¬Šæª¢æŸ¥å¤±æ•—
**ç—‡ç‹€**: æ“ä½œè¢«æ‹’çµ•ï¼Œé¡¯ç¤ºã€Œå­˜å–è¢«æ‹’çµ•ã€
**æ’é™¤æ­¥é©Ÿ**:
```javascript
// æª¢æŸ¥æ¬Šé™é…ç½®
const authResult = SecurityAuthHandler.validateAccess('card-data', 'write');
console.log('æˆæ¬Šçµæœ:', authResult);

// æª¢æŸ¥æœƒè©±ç‹€æ…‹
const sessionValid = SecurityAuthHandler.validateSession(sessionId);
console.log('æœƒè©±æœ‰æ•ˆ:', sessionValid);
```

#### 2. XSS é˜²è­·è§¸ç™¼
**ç—‡ç‹€**: è¼¸å…¥è¢«æ¸…ç†æˆ–æ‹’çµ•
**æ’é™¤æ­¥é©Ÿ**:
```javascript
// æ¸¬è©¦è¼¸å…¥æ¸…ç†
const result = SecurityDataHandler.sanitizeOutput(input, 'html');
console.log('æ¸…ç†çµæœ:', result);

// æª¢æŸ¥è¼¸å…¥é©—è­‰
const validation = SecurityInputHandler.validateAndSanitize(input, 'text');
console.log('é©—è­‰çµæœ:', validation);
```

#### 3. æœƒè©±è¶…æ™‚å•é¡Œ
**ç—‡ç‹€**: ç”¨æˆ¶é »ç¹éœ€è¦é‡æ–°ç™»å…¥
**æ’é™¤æ­¥é©Ÿ**:
```javascript
// æª¢æŸ¥æœƒè©±é…ç½®
console.log('æœƒè©±è¶…æ™‚è¨­å®š:', SecurityConfig.session.timeout);

// æª¢æŸ¥æœƒè©±çºŒæœŸ
SecurityAuthHandler.renewSession(sessionId);
```

## ğŸ“ˆ æ•ˆèƒ½ç›£æ§

### å®‰å…¨åŠŸèƒ½æ•ˆèƒ½æŒ‡æ¨™
- è¼¸å…¥é©—è­‰å»¶é²: < 10ms
- æˆæ¬Šæª¢æŸ¥å»¶é²: < 5ms
- æ—¥èªŒè¨˜éŒ„å»¶é²: < 2ms
- æœƒè©±é©—è­‰å»¶é²: < 3ms

### æ•ˆèƒ½å„ªåŒ–å»ºè­°
1. å¿«å–æˆæ¬Šçµæœ (5åˆ†é˜)
2. æ‰¹æ¬¡è™•ç†æ—¥èªŒå¯«å…¥
3. ä½¿ç”¨ç´¢å¼•åŠ é€Ÿæœƒè©±æŸ¥è©¢
4. å®šæœŸæ¸…ç†éæœŸè³‡æ–™

## ğŸ”„ æ›´æ–°èˆ‡å‡ç´š

### å®‰å…¨æ›´æ–°æµç¨‹
1. **è©•ä¼°éšæ®µ**: åˆ†æå®‰å…¨æ›´æ–°å½±éŸ¿
2. **æ¸¬è©¦éšæ®µ**: åœ¨æ¸¬è©¦ç’°å¢ƒé©—è­‰
3. **éƒ¨ç½²éšæ®µ**: åˆ†éšæ®µç”Ÿç”¢éƒ¨ç½²
4. **é©—è­‰éšæ®µ**: ç¢ºèªæ›´æ–°æˆåŠŸ
5. **ç›£æ§éšæ®µ**: æŒçºŒç›£æ§ç©©å®šæ€§

### ç·Šæ€¥å®‰å…¨è£œä¸
- ç«‹å³éš”é›¢å—å½±éŸ¿ç³»çµ±
- æ‡‰ç”¨è‡¨æ™‚ç·©è§£æªæ–½
- å¿«é€Ÿæ¸¬è©¦é—œéµåŠŸèƒ½
- éƒ¨ç½²å®‰å…¨è£œä¸
- å…¨é¢ç³»çµ±æª¢æŸ¥

## ğŸ“š åˆè¦æ€§æª¢æŸ¥

### OWASP Top 10 å°æ‡‰
- âœ… A01: å­˜å–æ§åˆ¶å¤±æ•ˆ â†’ SecurityAuthHandler
- âœ… A02: åŠ å¯†æ©Ÿåˆ¶å¤±æ•ˆ â†’ SecurityDataHandler
- âœ… A03: æ³¨å…¥æ”»æ“Š â†’ SecurityInputHandler
- âœ… A04: ä¸å®‰å…¨è¨­è¨ˆ â†’ å®‰å…¨æ¶æ§‹è¨­è¨ˆ
- âœ… A05: å®‰å…¨é…ç½®éŒ¯èª¤ â†’ é…ç½®ç®¡ç†
- âœ… A06: æ˜“å—æ”»æ“Šå…ƒä»¶ â†’ ä¾è³´ç®¡ç†
- âœ… A07: èº«ä»½é©—è­‰å¤±æ•ˆ â†’ æœƒè©±ç®¡ç†
- âœ… A08: è»Ÿé«”å®Œæ•´æ€§å¤±æ•ˆ â†’ å®Œæ•´æ€§æª¢æŸ¥
- âœ… A09: æ—¥èªŒç›£æ§å¤±æ•ˆ â†’ å®‰å…¨æ—¥èªŒ
- âœ… A10: ä¼ºæœå™¨ç«¯è«‹æ±‚å½é€  â†’ è¼¸å…¥é©—è­‰

### æ”¿åºœè³‡å®‰è¦ç¯„
- ç¬¦åˆæ•¸ä½ç™¼å±•éƒ¨è³‡å®‰è¦æ±‚
- éµå¾ªå€‹è³‡æ³•ç›¸é—œè¦å®š
- å¯¦ä½œè³‡æ–™æœ€å°åŒ–åŸå‰‡
- å»ºç«‹å®Œæ•´ç¨½æ ¸è»Œè·¡

## ğŸ†˜ ç·Šæ€¥è¯çµ¡è³‡è¨Š

### å®‰å…¨äº‹ä»¶å›æ‡‰å°çµ„
- **å®‰å…¨è² è²¬äºº**: [è¯çµ¡è³‡è¨Š]
- **æŠ€è¡“è² è²¬äºº**: [è¯çµ¡è³‡è¨Š]
- **æ³•å‹™è¯çµ¡äºº**: [è¯çµ¡è³‡è¨Š]
- **å…¬é—œè¯çµ¡äºº**: [è¯çµ¡è³‡è¨Š]

### å¤–éƒ¨è³‡æº
- **CERT/CC**: https://www.cert.org/
- **CVE è³‡æ–™åº«**: https://cve.mitre.org/
- **OWASP**: https://owasp.org/

---

**æ–‡ä»¶ç‰ˆæœ¬**: v2.0  
**æœ€å¾Œæ›´æ–°**: 2025-01-03 (æ–°å¢ PWA å®‰å…¨æ¸¬è©¦å¥—ä»¶æŒ‡å¼•)  
**ä¸‹æ¬¡å¯©æŸ¥**: 2025-02-03  
**ç¶­è­·è€…**: å®‰å…¨åœ˜éšŠ + æ¸¬è©¦åœ˜éšŠ  
**æ¸¬è©¦å¥—ä»¶ç‰ˆæœ¬**: v3.0.0 (Jest + è¦–è¦ºåŒ–å·¥å…·)