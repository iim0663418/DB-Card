# Vulnerability Communication Procedure
**Version**: 1.0.0  
**Last Updated**: 2026-02-02

## Purpose
Define procedures for communicating known vulnerabilities to customers and third parties.

## Scope
Applies to all high/critical vulnerabilities discovered in DB-Card production releases.

## Communication Triggers

### Customer Notification Required When:
- High or critical CVE affects deployed version
- Vulnerability requires customer action (e.g., re-deployment)
- Data breach or security incident occurs

### Third-Party Export Required When:
- Vulnerability affects shared components
- Downstream projects may be impacted
- Coordinated disclosure is needed

## Communication Channels

### Internal
- GitHub Security Advisories (private)
- Internal issue tracker
- Security team email

### External - Customers
- GitHub Security Advisories (public after fix)
- Release notes with security section
- Email to known deployments (if applicable)

### External - Third Parties
- CVE database submission
- OpenChain community notification
- Upstream project notification

## Communication Template

### Customer Notification
```
Subject: [SECURITY] DB-Card v{VERSION} - {CVE-ID} - {SEVERITY}

Summary: {Brief description}

Affected Versions: {version range}
Fixed In: {version}

Impact: {What could happen}

Action Required:
1. Update to version {fixed_version}
2. Run: npm install && wrangler deploy

Timeline:
- Discovered: {date}
- Fixed: {date}
- Disclosed: {date}

References:
- CVE: {link}
- Fix PR: {link}
- Security Advisory: {link}
```

### Third-Party Export Format
```json
{
  "vulnerability_id": "CVE-YYYY-XXXXX",
  "product": "DB-Card",
  "affected_versions": "4.0.0 - 4.6.0",
  "fixed_version": "4.6.1",
  "severity": "HIGH",
  "cwe": "CWE-XXX",
  "description": "...",
  "references": ["..."]
}
```

## Post-Release Monitoring

### Continuous Scanning
- **Frequency**: Weekly automated scans
- **Tool**: OSV-Scanner + npm audit
- **Scope**: All production releases (v4.x)

### New CVE Detection
When new CVE published affecting DB-Card:
1. Security Lead notified within 24 hours
2. Impact assessment within 48 hours
3. Fix developed within 30 days
4. Customers notified per template above

### Monitoring Tools
- GitHub Dependabot alerts
- OSV-Scanner scheduled runs
- npm audit in CI/CD
- Security mailing list subscriptions

## Procedure

### Step 1: Vulnerability Identified
- Log in issue tracker (private)
- Assign severity (CVSS score)
- Determine affected versions

### Step 2: Impact Assessment
- Identify affected customers
- Determine required actions
- Assess disclosure timeline

### Step 3: Fix Development
- Create private security branch
- Develop and test fix
- Prepare release notes

### Step 4: Coordinated Disclosure
- Notify customers 7 days before public disclosure (if possible)
- Publish GitHub Security Advisory
- Release fixed version
- Update CVE database

### Step 5: Post-Disclosure
- Monitor for exploitation attempts
- Track customer update adoption
- Document lessons learned

## Responsibility Matrix

| Task | Responsible | Accountable | Consulted | Informed |
|------|-------------|-------------|-----------|----------|
| Vulnerability Detection | Automated Tools | Security Lead | - | All |
| Impact Assessment | Security Lead | Project Lead | Developers | Customers |
| Fix Development | Developers | Security Lead | Reviewers | - |
| Customer Notification | Security Lead | Project Lead | - | All Customers |
| CVE Submission | Security Lead | Project Lead | - | Community |

## SLA Targets

| Severity | Assessment | Fix | Notification |
|----------|-----------|-----|--------------|
| Critical | 24 hours | 7 days | Before fix |
| High | 48 hours | 30 days | Before fix |
| Medium | 7 days | 90 days | With fix |
| Low | 30 days | Next release | Release notes |

---
**Owner**: Security Lead  
**Next Review**: 2026-05-02
